<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:local="clr-namespace:sUpdater.Controls">

    <DataTemplate x:Key="CustomItemTemplate">
        <Grid Height="50px">
            <Grid.ColumnDefinitions>
                <ColumnDefinition x:Name="checkColumn" Width="20px"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <CheckBox x:Name="checkBox" VerticalAlignment="Center"
                      IsChecked="{Binding Path=IsSelected, 
                      RelativeSource={RelativeSource FindAncestor, 
                      AncestorType={x:Type ListViewItem}}}" Grid.Column="0"/>

            <StackPanel Grid.Column="1" Orientation="Vertical" Margin="5,0,0,0">
                <Label FontSize="14" Content="{Binding Name}"/>
                <Label Margin="0,-5,0,0" Content="{Binding DisplayedVersion}" Foreground="#8d8d8d"/>
            </StackPanel>

            <StackPanel Grid.Column="3" Orientation="Vertical" HorizontalAlignment="Right"
                        VerticalAlignment="Center">
                <ProgressBar x:Name="progressBar"  Height="20px" Width="225px" Margin="0,10,0,0" 
                             Minimum="0" Maximum="100" Value="{Binding Progress}"/>
                <Label Foreground="#00ba00" FontWeight="Bold" 
                       HorizontalAlignment="Center" Content="{Binding Status}"/>
            </StackPanel>
        </Grid>

        <DataTemplate.Triggers>
            <!-- Show and hide the checkColumn when the Checkbox property is changed -->
            <DataTrigger Binding="{Binding Checkbox}" Value="True">
                <Setter TargetName="checkColumn" Property="Width" Value="20px"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding Checkbox}" Value="False">
                <Setter TargetName="checkColumn" Property="Width" Value="0"/>
            </DataTrigger>

            <!-- Hide the progress bar if the Progress property is set to 0 or it is unassigned -->
            <DataTrigger Binding="{Binding Progress}" Value="0">
                <Setter TargetName="progressBar" Property="Visibility" Value="Collapsed"/>
            </DataTrigger>

            <!-- Set the progress bar to the Indeterminate mode if the IsWaiting property is set to true -->
            <DataTrigger Binding="{Binding IsWaiting}" Value="True">
                <Setter TargetName="progressBar" Property="IsIndeterminate" Value="True"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding IsWaiting}" Value="False">
                <Setter TargetName="progressBar" Property="IsIndeterminate" Value="False"/>
            </DataTrigger>
        </DataTemplate.Triggers>
    </DataTemplate>

    <Style x:Key="CustomListViewStyle" TargetType="ListView">
        <Setter Property="VirtualizingPanel.ScrollUnit" Value="Pixel"/>
        <Setter Property="HorizontalAlignment" Value="Stretch"/>
        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
        <Setter Property="SelectionMode" Value="Multiple"/>

        <Setter Property="ItemTemplate" Value="{StaticResource CustomItemTemplate}"/>
    </Style>
</ResourceDictionary>